<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureAI DeepFake Detection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
        }
        
        .glass-effect {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        .upload-zone {
            border: 2px dashed #64748b;
            transition: all 0.3s ease;
            background: rgba(15, 23, 42, 0.5);
        }
        
        .upload-zone.dragover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06b6d4);
            background-size: 200% 100%;
            animation: progress-flow 2s ease-in-out infinite;
        }
        
        @keyframes progress-flow {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .confidence-gauge {
            background: conic-gradient(from 0deg, #ef4444 0deg, #f59e0b 120deg, #10b981 240deg, #10b981 360deg);
        }
        
        .pulse-ring {
            animation: pulse-ring 1.25s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        
        @keyframes pulse-ring {
            0% { transform: scale(0.33); }
            40%, 50% { opacity: 1; }
            100% { opacity: 0; transform: scale(1.33); }
        }
        
        .scan-line {
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.5), transparent);
            animation: scan 2s linear infinite;
        }
        
        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
    </style>
</head>
<body class="text-slate-100">
    <!-- Navigation -->
    <nav class="glass-effect border-b border-slate-700/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-shield-alt text-white text-sm"></i>
                    </div>
                    <h1 class="text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                        SecureAI DeepFake Detection
                    </h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="text-slate-400 hover:text-white transition-colors">
                        <i class="fas fa-history"></i>
                    </button>
                    <button class="text-slate-400 hover:text-white transition-colors">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Upload Section -->
        <div id="upload-section" class="mb-8">
            <div class="glass-effect rounded-2xl p-8">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-4">DeepFake Detection Analysis</h2>
                    <p class="text-slate-400 text-lg">Upload a video file to analyze for potential deepfake manipulation</p>
                </div>
                
                <!-- Upload Zone -->
                <div id="upload-zone" class="upload-zone rounded-xl p-12 text-center cursor-pointer">
                    <div class="mb-6">
                        <i class="fas fa-cloud-upload-alt text-6xl text-slate-400 mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Drag & Drop Video Here</h3>
                        <p class="text-slate-400 mb-4">or click to browse files</p>
                        <button id="browse-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                            <i class="fas fa-folder-open mr-2"></i>Browse Files
                        </button>
                    </div>
                    <div class="text-sm text-slate-500">
                        <p>Supported formats: MP4, AVI, MOV, MKV, WEBM</p>
                        <p>Maximum file size: 500MB</p>
                    </div>
                </div>
                
                <input type="file" id="file-input" accept="video/*" class="hidden">
            </div>
        </div>

        <!-- Processing Section -->
        <div id="processing-section" class="hidden mb-8">
            <div class="glass-effect rounded-2xl p-8">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold mb-4">Analyzing Video</h2>
                    <p class="text-slate-400">Please wait while our AI models process your video</p>
                </div>
                
                <!-- Progress Steps -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                    <div class="process-step active" data-step="1">
                        <div class="flex items-center space-x-3 p-4 rounded-lg bg-slate-800/50">
                            <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-bold">1</div>
                            <div>
                                <h4 class="font-medium">Frame Extraction</h4>
                                <p class="text-sm text-slate-400">Extracting key frames</p>
                            </div>
                        </div>
                    </div>
                    <div class="process-step" data-step="2">
                        <div class="flex items-center space-x-3 p-4 rounded-lg bg-slate-800/50">
                            <div class="w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center text-white text-sm font-bold">2</div>
                            <div>
                                <h4 class="font-medium">Biometric Analysis</h4>
                                <p class="text-sm text-slate-400">Analyzing facial features</p>
                            </div>
                        </div>
                    </div>
                    <div class="process-step" data-step="3">
                        <div class="flex items-center space-x-3 p-4 rounded-lg bg-slate-800/50">
                            <div class="w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center text-white text-sm font-bold">3</div>
                            <div>
                                <h4 class="font-medium">Artifact Detection</h4>
                                <p class="text-sm text-slate-400">Scanning for anomalies</p>
                            </div>
                        </div>
                    </div>
                    <div class="process-step" data-step="4">
                        <div class="flex items-center space-x-3 p-4 rounded-lg bg-slate-800/50">
                            <div class="w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center text-white text-sm font-bold">4</div>
                            <div>
                                <h4 class="font-medium">Final Scoring</h4>
                                <p class="text-sm text-slate-400">Generating results</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Progress Bar -->
                <div class="w-full bg-slate-700 rounded-full h-2 mb-4">
                    <div id="progress-bar" class="progress-bar h-2 rounded-full" style="width: 0%"></div>
                </div>
                <div class="text-center">
                    <p id="progress-text" class="text-slate-400">Initializing...</p>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="hidden">
            <!-- Main Result Card -->
            <div class="glass-effect rounded-2xl p-8 mb-8">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold mb-4">Analysis Complete</h2>
                    <div id="main-result" class="flex items-center justify-center space-x-4">
                        <!-- Result will be populated here -->
                    </div>
                </div>
                
                <!-- Confidence Gauge -->
                <div class="flex justify-center mb-8">
                    <div class="relative">
                        <div id="confidence-gauge" class="w-32 h-32 rounded-full confidence-gauge flex items-center justify-center">
                            <div class="w-24 h-24 bg-slate-900 rounded-full flex items-center justify-center">
                                <span id="confidence-score" class="text-2xl font-bold text-white">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="flex justify-center space-x-4">
                    <button id="export-report" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                        <i class="fas fa-download mr-2"></i>Export Report
                    </button>
                    <button id="analyze-another" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                        <i class="fas fa-plus mr-2"></i>Analyze Another Video
                    </button>
                </div>
            </div>
            
            <!-- Detailed Results -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Video Player -->
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-xl font-semibold mb-4">Video Analysis</h3>
                    <div class="aspect-video bg-slate-800 rounded-lg mb-4 flex items-center justify-center">
                        <video id="result-video" controls class="max-w-full max-h-full rounded-lg">
                            <source src="" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    <div class="text-sm text-slate-400">
                        <p>Video: <span id="video-filename">-</span></p>
                        <p>Duration: <span id="video-duration">-</span></p>
                        <p>Processing Time: <span id="processing-time">-</span></p>
                    </div>
                </div>
                
                <!-- Forensic Breakdown -->
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-xl font-semibold mb-4">Forensic Breakdown</h3>
                    <div class="space-y-4">
                        <div class="bg-slate-800/50 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium">Visual Artifacts</h4>
                                <span id="visual-score" class="text-sm text-blue-400">-</span>
                            </div>
                            <div class="w-full bg-slate-700 rounded-full h-2">
                                <div id="visual-bar" class="bg-blue-500 h-2 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="bg-slate-800/50 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium">Facial Geometry</h4>
                                <span id="geometry-score" class="text-sm text-purple-400">-</span>
                            </div>
                            <div class="w-full bg-slate-700 rounded-full h-2">
                                <div id="geometry-bar" class="bg-purple-500 h-2 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="bg-slate-800/50 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium">Motion Consistency</h4>
                                <span id="motion-score" class="text-sm text-green-400">-</span>
                            </div>
                            <div class="w-full bg-slate-700 rounded-full h-2">
                                <div id="motion-bar" class="bg-green-500 h-2 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Global variables
        let currentFile = null;
        let analysisResult = null;

        // DOM elements
        const uploadZone = document.getElementById('upload-zone');
        const fileInput = document.getElementById('file-input');
        const browseBtn = document.getElementById('browse-btn');
        const uploadSection = document.getElementById('upload-section');
        const processingSection = document.getElementById('processing-section');
        const resultsSection = document.getElementById('results-section');

        // Event listeners
        browseBtn.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', handleFileSelect);
        
        uploadZone.addEventListener('click', () => fileInput.click());
        uploadZone.addEventListener('dragover', handleDragOver);
        uploadZone.addEventListener('dragleave', handleDragLeave);
        uploadZone.addEventListener('drop', handleDrop);

        // File handling functions
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                processFile(file);
            }
        }

        function handleDragOver(event) {
            event.preventDefault();
            uploadZone.classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            uploadZone.classList.remove('dragover');
        }

        function handleDrop(event) {
            event.preventDefault();
            uploadZone.classList.remove('dragover');
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        }

        function processFile(file) {
            // Validate file
            if (!file.type.startsWith('video/')) {
                showError('Please select a valid video file.');
                return;
            }
            
            if (file.size > 500 * 1024 * 1024) {
                showError('File size must be less than 500MB.');
                return;
            }

            currentFile = file;
            startAnalysis();
        }

        function startAnalysis() {
            uploadSection.classList.add('hidden');
            processingSection.classList.remove('hidden');
            
            // Start progress animation
            simulateProgress();
            
            // Upload file and start analysis
            uploadAndAnalyze();
        }

        function simulateProgress() {
            const steps = document.querySelectorAll('.process-step');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            
            let currentStep = 0;
            const stepTexts = [
                'Extracting frames from video...',
                'Analyzing biometric features...',
                'Scanning for manipulation artifacts...',
                'Generating final confidence score...'
            ];
            
            const interval = setInterval(() => {
                if (currentStep < steps.length) {
                    // Update step
                    steps[currentStep].querySelector('.w-8').classList.remove('bg-slate-600');
                    steps[currentStep].querySelector('.w-8').classList.add('bg-blue-600');
                    
                    // Update progress bar
                    const progress = ((currentStep + 1) / steps.length) * 100;
                    progressBar.style.width = progress + '%';
                    progressText.textContent = stepTexts[currentStep];
                    
                    currentStep++;
                } else {
                    clearInterval(interval);
                }
            }, 2000);
        }

        async function uploadAndAnalyze() {
            const formData = new FormData();
            formData.append('video', currentFile);
            
            try {
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    throw new Error('Analysis failed');
                }
                
                analysisResult = await response.json();
                
                // Wait a bit for progress animation to complete
                setTimeout(() => {
                    showResults();
                }, 1000);
                
            } catch (error) {
                console.error('Error:', error);
                showError('Analysis failed. Please try again.');
            }
        }

        function showResults() {
            processingSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            
            // Populate results
            populateResults();
        }

        function populateResults() {
            const result = analysisResult.result;
            const confidence = Math.round(result.confidence * 100);
            const isFake = result.is_fake;
            
            // Main result
            const mainResult = document.getElementById('main-result');
            if (isFake) {
                mainResult.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-exclamation-triangle text-4xl text-red-500"></i>
                        <div>
                            <h3 class="text-2xl font-bold text-red-400">DEEPFAKE DETECTED</h3>
                            <p class="text-slate-400">High probability of manipulation</p>
                        </div>
                    </div>
                `;
            } else {
                mainResult.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-check-circle text-4xl text-green-500"></i>
                        <div>
                            <h3 class="text-2xl font-bold text-green-400">AUTHENTIC VIDEO</h3>
                            <p class="text-slate-400">No signs of manipulation detected</p>
                        </div>
                    </div>
                `;
            }
            
            // Confidence score
            document.getElementById('confidence-score').textContent = confidence + '%';
            
            // Video info
            document.getElementById('video-filename').textContent = analysisResult.filename || 'Unknown';
            document.getElementById('processing-time').textContent = analysisResult.processing_time + 's';
            
            // Forensic breakdown (simulated data for demo)
            const visualScore = Math.round(Math.random() * 100);
            const geometryScore = Math.round(Math.random() * 100);
            const motionScore = Math.round(Math.random() * 100);
            
            document.getElementById('visual-score').textContent = visualScore + '%';
            document.getElementById('geometry-score').textContent = geometryScore + '%';
            document.getElementById('motion-score').textContent = motionScore + '%';
            
            document.getElementById('visual-bar').style.width = visualScore + '%';
            document.getElementById('geometry-bar').style.width = geometryScore + '%';
            document.getElementById('motion-bar').style.width = motionScore + '%';
        }

        function showError(message) {
            alert(message); // Replace with better error UI
        }

        // Event listeners for buttons
        document.getElementById('analyze-another').addEventListener('click', () => {
            resultsSection.classList.add('hidden');
            uploadSection.classList.remove('hidden');
            currentFile = null;
            analysisResult = null;
        });

        document.getElementById('export-report').addEventListener('click', () => {
            // Implement export functionality
            alert('Export functionality will be implemented');
        });
    </script>
</body>
</html>
